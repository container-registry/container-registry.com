<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>How to automate Flask development workflow with Container Registry and GitHub Actions - Container Registry</title>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=title property="og:title" content="How to automate Flask development workflow with Container Registry and GitHub Actions"><meta name=description property="og:description" content="The goal of this tutorial is to develop an automated workflow to build a containerized Flask application. We will run the workflow with GitHub Actions and use 8gears Container Registry as our image repository"><meta name=tags content="Tutorial,Container Registry,Automation"><meta name=twitter:title content="How to automate Flask development workflow with Container Registry and GitHub Actions"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@ContainerRgstry"><meta name=twitter:creator content="@indikaimk"><meta name=twitter:image property="og:image" content="https://container-registry.com/posts/how-to-automate-flask-development-workflow/background.jpg"><link rel=icon href=https://container-registry.com/favicon.png><link rel=apple-touch-icon sizes=180x180 href=https://container-registry.com//favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://container-registry.com//favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://container-registry.com//favicon/favicon-16x16.png><link rel=manifest href=https://container-registry.com//favicon/site.webmanifest><link rel=mask-icon href=https://container-registry.com//favicon/safari-pinned-tab.svg color=#5bbad5><link rel="shortcut icon" href=https://container-registry.com//favicon/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config content="https://container-registry.com//favicon/browserconfig.xml"><meta name=theme-color content="#ffffff"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@100;500&family=Open+Sans&display=swap" rel=stylesheet><link rel=stylesheet href=/css/style.min.fdc3cc3c5651044d7ff358a0626f6effac444e4c0f7d5aad44dba718ad4fe89e.css><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-P2NXZV4")</script><script src=https://js.sentry-cdn.com/b9481453656a4f9daa3270f89fa3b817.min.js crossorigin=anonymous></script><script defer src=https://unpkg.com/alpinejs@3.10.2/dist/cdn.min.js></script><script defer src=https://js.chargebee.com/v2/chargebee.js data-cb-site=container-registry></script></head><body class='page page-posts-single'><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P2NXZV4" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><div id=main-menu-mobile class=main-menu-mobile><ul><li class=menu-item-pricing><a href=/#pricing><span>Pricing</span></a></li><li class="menu-item-knowledge base"><a href=/docs/><span>Knowledge Base</span></a></li><li class=menu-item-faq><a href=/faq/><span>FAQ</span></a></li><li class=menu-item-about><a href=/about/><span>About</span></a></li><li class=menu-item-blog><a href=/posts/><span>Blog</span></a></li><li class=menu-item-contact><a href=/contact/><span>Contact</span></a></li><li class=menu-item-jobs><a href=https://8gears.notion.site/Open-Positions-c118efd6a984438b8def1bb8ae9c2419><span>Jobs</span></a></li></ul></div><div id=header class='header header-fixed'><div class=container><div class=logos><div class=logo><a href=https://container-registry.com/><img height=70px width=70px alt="Container Registry Logo" src=/img/logo.svg></a></div><div class=logo-invert><a href=https://container-registry.com/><img height=70px width=70px alt="Container Registry Logo" src=/img/logo-white.svg></a></div><div class=logo-mobile><a href=https://container-registry.com/><img height=64px width=64px alt="Container Registry Logo" src=/img/logo.svg></a></div><div class=logo-invert-mobile><a href=https://container-registry.com/><img height=64px width=64px alt="Container Registry Logo" src=/img/logo-white.svg></a></div></div><div class=main-menu><ul><li class=menu-item-pricing><a href=/#pricing><span>Pricing</span></a><li class="menu-item-knowledge base"><a href=/docs/><span>Knowledge Base</span></a><li class=menu-item-faq><a href=/faq/><span>FAQ</span></a><li class=menu-item-about><a href=/about/><span>About</span></a><li class=menu-item-blog><a href=/posts/><span>Blog</span></a><li class=menu-item-contact><a href=/contact/><span>Contact</span></a><li class=menu-item-jobs><a href=https://8gears.notion.site/Open-Positions-c118efd6a984438b8def1bb8ae9c2419><span>Jobs</span></a></ul></div><div id=toggle-main-menu-mobile class=menu-trigger><button class=hamburger>Menu</button></div></div></div><div id=wrapper class=wrapper><div class="hero hero-set-height" style=height:600px><div class=hero-image style=background-image:url(/posts/how-to-automate-flask-development-workflow/background.jpg);background-position:50%><div class=container><div class=hero-text><h1 class=mb-1 style=color:#fff>How to automate Flask development workflow with Container Registry and GitHub Actions</h1><p style=color:#fff>Build an automated workflow with Container Registry and GitHub actions.</p></div></div></div></div><div class="strip strip-white"><div class="container pt-4 pt-md-10 pb-4 pb-md-10"><div class="row justify-content-start"><div class="col-12 col-md-10 col-lg-8 col-xl-7"><div class="post post-single"><div class="content pb-5"><p>In this tutorial, we will develop an automated workflow to build a containerized Flask application.</p><p>This workflow will build a new container image every time a new commit is pushed to our GitHub repository. We will be using a simple Flask application for this tutorial. But you can use this workflow to build a Flask application of any complexity.</p><p>We will run the workflow with <a href=https://docs.github.com/en/actions>GitHub Actions</a> and use <a href=https://container-registry.com/>8gears Container Registry</a> as our image repository.</p><p><a href=https://container-registry.com/>8gears Container Registry</a> is a Harbor-based container registry as a service. You can use <a href=https://container-registry.com/>8gears Container Registry</a> as a replacement for Docker Hub in your DevOps toolbox.</p><p>For this tutorial, you will need:</p><ol><li>A development workstation running Ubuntu OS 18.04 or later</li><li>A GitHub account</li></ol><p>Also, you need to be familiar with Flask and Python.</p><div class="note info"><div class=icon><img src=/images/icons/ico-info.svg alt></div><div class=note-content><h3 class=title>INFO</h3><p>These are the steps that we will be following in this tutorial.</p><ol><li>Create a Flask web application</li><li>Create a GitHub repository</li><li>Containerize the Flask application</li><li>Set up 8gears Container Registry</li><li>Automate the build workflow with GitHub Actions</li><li>Run the GitHub Actions Workflow</li></ol></div></div><h2 id=create-a-flask-web-application>Create a Flask web application</h2><p>Letâ€™s start by creating a new web application with <a href=https://flask.palletsprojects.com/en/3.0.x/>Flask</a>.</p><p>In the development workstation, create a new project directory and set up the
Python virtual environment.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install python3-venv
</span></span><span style=display:flex><span>mkdir my-flask-app
</span></span><span style=display:flex><span>cd my-flask-app/
</span></span><span style=display:flex><span>python3 -m venv .venv
</span></span><span style=display:flex><span>. .venv/bin/activate
</span></span><span style=display:flex><span> pip install Flask
</span></span></code></pre></div><p>Create a simple Flask app by copy-pasting the below code to <code>app.py</code> inside the project directory.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> flask <span style=color:#f92672>import</span> Flask
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app <span style=color:#f92672>=</span> Flask(__name__)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#34;/&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>hello_world</span>():
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;&lt;p&gt;This is a containerized Flask app&lt;/p&gt;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>   app<span style=color:#f92672>.</span>run()
</span></span></code></pre></div><p>This Flask app has just one page. You can substitute this with any Flask app you
have previously created.</p><p>Run the application.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ flask run
</span></span><span style=display:flex><span> * Debug mode: off
</span></span><span style=display:flex><span>WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
</span></span><span style=display:flex><span> * Running on &lt;http://127.0.0.1:5000&gt;
</span></span><span style=display:flex><span>Press CTRL+C to quit
</span></span><span style=display:flex><span>127.0.0.1 - - <span style=color:#f92672>[</span>27/Nov/2023 04:32:30<span style=color:#f92672>]</span> <span style=color:#e6db74>&#34;GET / HTTP/1.1&#34;</span> <span style=color:#ae81ff>200</span> -
</span></span></code></pre></div><p>Flask runs our application with a <code>development server</code> which listens on port 5000. Open a new terminal in the development workstation and test the application with <code>curl</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl &lt;http://127.0.0.1:5000&gt;
</span></span><span style=display:flex><span>&lt;p&gt;This is a containerized Flask app&lt;/p&gt;
</span></span></code></pre></div><p>Now, we have a working Flask application. But the Flask <code>development server</code> is not suitable to run Flask in production. So every time we use <code>flask run</code> we get this warning.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
</span></span></code></pre></div><p>To fix this warning and <a href=https://flask.palletsprojects.com/en/3.0.x/deploying/>prepare our application for the production environment</a> we need a production-ready WSGI server like <a href=https://flask.palletsprojects.com/en/3.0.x/deploying/gunicorn/>Gunicorn</a>.</p><p>Install Gunicorn in the development workstation.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pip install gunicorn
</span></span></code></pre></div><p>In the working directory, add <code>wsgi.py</code> with this content.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> app <span style=color:#f92672>import</span> app
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>   app<span style=color:#f92672>.</span>run()
</span></span></code></pre></div><p>Run the Flask app with Gunicorn.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gunicorn wsgi:app
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2023-11-27 04:38:39 +0530<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>2119<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> Starting gunicorn 21.2.0
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2023-11-27 04:38:39 +0530<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>2119<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> Listening at: &lt;http://127.0.0.1:8000&gt; <span style=color:#f92672>(</span>2119<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2023-11-27 04:38:39 +0530<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>2119<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> Using worker: sync
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2023-11-27 04:38:39 +0530<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>2120<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> Booting worker with pid: <span style=color:#ae81ff>2120</span>
</span></span></code></pre></div><p>Test with <code>curl</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl &lt;http://127.0.0.1:8000&gt;
</span></span><span style=display:flex><span>&lt;p&gt;This is a containerized Flask app&lt;/p&gt;
</span></span></code></pre></div><p>Now, our Flask app is ready to be deployed into production.</p><h2 id=create-a-github-repository>Create a GitHub repository</h2><p>We are using <a href=https://docs.github.com/en/actions>GitHub Actions</a> to automate the build workflow for our Flask app. GitHub Actions is a CI/CD platform that automates software development workflows for GitHub repositories.</p><p>To use GitHub Actions, we must create a GitHub repository for our Flask app.</p><p>Create <code>.gitignore</code> file in the working directory and add these two paths, which
we do not want to version control with <code>git</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>.venv/*
</span></span><span style=display:flex><span>__*
</span></span></code></pre></div><p>Initialize local Git repository.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git init
</span></span><span style=display:flex><span>git add .
</span></span><span style=display:flex><span>git commit -m <span style=color:#e6db74>&#34;version 1&#34;</span>
</span></span></code></pre></div><p>Go to GitHub and create a repository named <code>my-flask-app</code>.</p><p>In the local repository, change the branch name to <code>main</code> and push the code to the newly created repository. Make sure to replace <code>your-github-username</code> with your actual username in GitHub.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git branch -M main
</span></span><span style=display:flex><span>git remote add origin git@github.com:&lt;your-github-username&gt;/my-flask-app.git
</span></span><span style=display:flex><span>git push -u origin main
</span></span></code></pre></div><p>Before using <code>git push</code> you must set up authentication with GitHub via <a href=https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens>Personal Access Tokens</a> or <a href=https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent>SSH keys</a>.</p><h2 id=containerize-the-flask-application>Containerize the Flask application</h2><p>To build container images, we will use <a href=https://docs.docker.com/engine/reference/commandline/buildx/>Docker Buildx</a>. So, letâ€™s install <code>docker</code> and <code>docker-buildx</code> in the development machine.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install docker docker-buildx
</span></span></code></pre></div><p>Add user <code>ubuntu</code> to the <code>docker</code> group so we can run the <code>docker</code> command without <code>sudo</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo groupadd docker
</span></span><span style=display:flex><span>sudo usermod -aG docker $USER
</span></span></code></pre></div><p>Create a Python <code>requirements.txt</code> file in the working directory.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>flask <span style=color:#f92672>==</span> 3.0.0
</span></span><span style=display:flex><span>gunicorn
</span></span></code></pre></div><p>The Python package manager <code>pip</code> uses the <code>requirements.txt</code> file to install the
package dependencies. In the working directory, create <code>Dockerfile</code> with this
content.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>FROM python:3.13.0a1-alpine <span style=color:#75715e>#1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Copy the requirements and install</span>
</span></span><span style=display:flex><span>COPY requirements.txt ./ <span style=color:#75715e>#2</span>
</span></span><span style=display:flex><span>RUN pip install --no-cache-dir -r requirements.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set destination for COPY</span>
</span></span><span style=display:flex><span>WORKDIR /app <span style=color:#75715e>#3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># copy the application to the working directory.</span>
</span></span><span style=display:flex><span>COPY . . <span style=color:#75715e>#4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>EXPOSE <span style=color:#ae81ff>8000</span> <span style=color:#75715e>#5</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Run</span>
</span></span><span style=display:flex><span>CMD <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;gunicorn&#34;</span>, <span style=color:#e6db74>&#34;--bind=0.0.0.0:8000&#34;</span>, <span style=color:#e6db74>&#34;wsgi:app&#34;</span> <span style=color:#f92672>]</span> <span style=color:#75715e>#6</span>
</span></span></code></pre></div><div class=footnote_item><div class=footnote_item-number><span class=footnote-number>1</span></div><div class=footnote_item-inner><p>Use Docker image <code>python:3.13.0a1-alpine</code> as the base.</p></div></div><div class=footnote_item><div class=footnote_item-number><span class=footnote-number>2</span></div><div class=footnote_item-inner><p>Install the Python package dependencies in the Docker image.</p></div></div><div class=footnote_item><div class=footnote_item-number><span class=footnote-number>3</span></div><div class=footnote_item-inner><p>Set the working directory in the Docker image.</p></div></div><div class=footnote_item><div class=footnote_item-number><span class=footnote-number>4</span></div><div class=footnote_item-inner><p>Copy our Flask app to the working directory in the Docker image.</p></div></div><div class=footnote_item><div class=footnote_item-number><span class=footnote-number>5</span></div><div class=footnote_item-inner><p>Allow connecting to port 8000 from the external network, since the Flask app inside the container will be listening on port 8000.</p></div></div><div class=footnote_item><div class=footnote_item-number><span class=footnote-number>6</span></div><div class=footnote_item-inner><p>Run the Flask app with Gunicorn. Set the <code>bind</code> to <code>0.0.0.0:8000</code> so that Guncorn will listen on all interfaces of the container. If you did not set this, Gunicorn will listen only on <code>[localhost](http://localhost)</code> interface and will not accept requests coming from external networks.</p></div></div><p>Build the container image locally.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker build . -t my-flask-app:1.0.0
</span></span></code></pre></div><p>Run the container with <code>-p</code> flag to publish port 8000.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker run -p 8000:8000 my-flask-app:1.0.0
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2023-11-26 23:18:16 +0000<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> Starting gunicorn 21.2.0
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2023-11-26 23:18:16 +0000<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> Listening at: &lt;http://0.0.0.0:8000&gt; <span style=color:#f92672>(</span>1<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2023-11-26 23:18:16 +0000<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> Using worker: sync
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2023-11-26 23:18:16 +0000<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>6<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> Booting worker with pid: <span style=color:#ae81ff>6</span>
</span></span></code></pre></div><p>Test with <code>curl</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl &lt;http://127.0.0.1:8000&gt;
</span></span><span style=display:flex><span>&lt;p&gt;This is a containerized Flask app&lt;/p&gt;
</span></span></code></pre></div><p>Now, we have a production-ready containerized Flask app.</p><h2 id=set-up-8gears-container-registry>Set up 8gears Container Registry</h2><p><a href=http://container-registry.com/>8gears Container Registry</a> offers several plans including a free plan c8n.io
to help you get started. Go to <a href=http://container-registry.com/>container-registry.com</a> and create a new c8n
account or activate your <a href=https://github.com/marketplace/container-registry>Account</a>
from the GitHub Marketplace.</p><p>Once we are logged in to <a href=https://c8n.io>c8n.io</a>, we get the portal for
managing our artifacts, including container images.
<img src=/posts/how-to-automate-flask-development-workflow/screenshot-container-registry-portal.png alt="8gears Container Registry portal."></p><p>Click on the project named with your username. This is also marked
as <code>Project Admin</code>.
It takes us to the project details page. There are no repositories here yet.</p><p><img src=/posts/how-to-automate-flask-development-workflow/screenshot-container-registry-portal-repos.png alt="8gears Container Registry portal - your project."></p><p>To push the images to this registry from GitHub Actions, we need a Robot Account.</p><div class="note info"><div class=icon><img src=/images/icons/ico-info.svg alt></div><div class=note-content><h3 class=title>INFO</h3><p>You can provision multiple Robot Accounts and grant minimum required privileges for each account.
So, using a Robot Account is more secure than using the admin account in automated workflows.</p></div></div><p>On your project page in the portal, click on Robot Accounts and click on the <code>New Robot Account</code> button.
<img src=/posts/how-to-automate-flask-development-workflow/screenshot-robot-account.png alt="Creating new Robot Account."></p><p>Type in your username and select Expiration time as Never. Leave the Permission field as it is and click on the <code>Add</code> button.</p><p><img src=/posts/how-to-automate-flask-development-workflow/screenshot-robot-account-add.png alt="Add the Robot Account"></p><p>Your username will be of the format <code>robot_&lt;project_name>+username</code>. You must use this username to log in from the Robot Account.</p><p>On the next screen, click on Export to File to save the Secret to a file.
We require this Secret to log in to the Container Registry portal from Docker CLI.
Remember to safeguard your Robot Account Secrets, as anyone who gets access to a Secret gains access to your repositories.</p><p>We shall verify the Robot Account by pushing an image from the developer workstation.</p><p>By default, the Docker CLI pushes images to Docker Hub. To push images to a different registry,
we need to tag the image with the path of the registry as <code>&lt;hostname>/&lt;project>/&lt;image>:&lt;tag></code> format.
So, letâ€™s re-tag the image in the development workstation.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker image tag my-flask-app:1.0.0 c8n.io/&lt;project-name&gt;/my-flask-app
</span></span></code></pre></div><p>Make sure to replace <project-name>with your project name in Container Registry.</p><p>List the images to confirm.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker image ls
</span></span><span style=display:flex><span>REPOSITORY                      TAG       IMAGE ID       CREATED        SIZE
</span></span><span style=display:flex><span>c8n.io/indikaimk/my-flask-app   1.0.0     32436ea99088   <span style=color:#ae81ff>17</span> hours ago   88.2MB
</span></span><span style=display:flex><span>my-flask-app                    1.0.0     32436ea99088   <span style=color:#ae81ff>17</span> hours ago   88.2MB
</span></span></code></pre></div><p>Login to the Container Registry from Docker CLI using the Robot Account we just created. Make sure to replace <code>&lt;project-name></code> with your project name.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker login -u robot_&lt;project-name&gt;+developer c8n.io
</span></span><span style=display:flex><span>Password:
</span></span><span style=display:flex><span>WARNING! Your password will be stored unencrypted in /home/ubuntu/.docker/config.json.
</span></span><span style=display:flex><span>Configure a credential helper to remove this warning. See
</span></span><span style=display:flex><span>&lt;https://docs.docker.com/engine/reference/commandline/login/#credentials-store&gt;
</span></span><span style=display:flex><span>Login Succeeded
</span></span></code></pre></div><p>Push the image to the Container Registry.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker push c8n.io/&lt;project-name&gt;/my-flask-app:1.0.0
</span></span></code></pre></div><p>Go to the Container Registry portal and check the Repositories in your project.
<img src=/posts/how-to-automate-flask-development-workflow/screenshot-portal-with-repo.png alt="8gears Container Registry portal after pushing one image."></p><p>Click on the repository name and check the image that we just uploaded.</p><p><img src=/posts/how-to-automate-flask-development-workflow/screenshot-repo-one-image.png alt="8gears Container Registry portal image."></p><p>We have successfully pushed our image to the Container Registry using the Robot Account.</p><h2 id=automate-the-build-workflow-with-github-actions>Automate the build workflow with GitHub Actions</h2><p><a href=https://docs.github.com/en/actions>GitHub Actions</a> is a fully-fledged CI/CD workflow management system. Workflows in GitHub Actions are defined in YAML and stored in <code>.github/workflows</code> in the repository.</p><p>Hereâ€™s the structure of a GitHub Actions workflow.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#75715e># A name for this workflow(optional)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>: <span style=color:#75715e>#Event which triggers the workflow</span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>: <span style=color:#75715e># Steps of the workflow</span>
</span></span></code></pre></div><p>Create <code>build.yml</code> in <code>.github/workflows</code> inside the working directory and add the following content.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#e6db74>&#39;Build and push to container-registry.com&#39;</span>  <span style=color:#75715e>#1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>: <span style=color:#75715e>#2</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>push</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>branches</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>build_and_push</span>: <span style=color:#75715e>#3</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>build image and push</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span> <span style=color:#75715e>#4</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Set up QEMU</span> <span style=color:#75715e>#5</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>docker/setup-qemu-action@v3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Set up Docker Buidlx</span> <span style=color:#75715e>#4</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>docker/setup-buildx-action@v3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Login to container-registry</span> <span style=color:#75715e>#5</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>docker/login-action@v3</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>registry</span>: <span style=color:#ae81ff>c8n.io</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>username</span>: <span style=color:#ae81ff>${{ secrets.C8N_USERNAME }}</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>password</span>: <span style=color:#ae81ff>${{ secrets.C8N_SECRET }}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build and push container image</span> <span style=color:#75715e>#6</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>docker/build-push-action@v5</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>push</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>tags</span>: <span style=color:#ae81ff>c8n.io/indikaimk/my-flask-app:1.0.1</span>
</span></span></code></pre></div><div class=footnote_item><div class=footnote_item-number><span class=footnote-number>1</span></div><div class=footnote_item-inner><p>Name of the workflow</p></div></div><div class=footnote_item><div class=footnote_item-number><span class=footnote-number>2</span></div><div class=footnote_item-inner><p><code>on</code> defines the event that triggers this workflow. GitHub Actions triggers this workflow every time we push to the <code>main</code> branch.</p></div></div><div class=footnote_item><div class=footnote_item-number><span class=footnote-number>3</span></div><div class=footnote_item-inner><p>Steps to build and push the container image.</p></div></div><div class=footnote_item><div class=footnote_item-number><span class=footnote-number>4</span></div><div class=footnote_item-inner><p>Workflows in GitHub Actions run on virtual machines created on-demand. Choose the latest Ubuntu OS for the virtual machine.</p></div></div><div class=footnote_item><div class=footnote_item-number><span class=footnote-number>5</span></div><div class=footnote_item-inner><p>Install QEMU which is a dependency for Docker Buildx.</p></div></div><div class=footnote_item><div class=footnote_item-number><span class=footnote-number>6</span></div><div class=footnote_item-inner><p>Install Docker Buildx.</p></div></div><div class=footnote_item><div class=footnote_item-number><span class=footnote-number>7</span></div><div class=footnote_item-inner><p>Login to 8gears Container Registry with the Robot Account. Since we keep<code>build.yml</code> inside the repository, itâ€™s recommended not to use plain text credentials here. So, we use GitHub Actions Secrets. We will create the secrets in the next section.</p></div></div><div class=footnote_item><div class=footnote_item-number><span class=footnote-number>8</span></div><div class=footnote_item-inner><p>Build and push the container image. Note the use of the tag <code>c8n.io/&lt;project-name>/my-flask-app:1.0.1</code> to select our project in the Container Registry.</p></div></div><h2 id=create-github-secrets>Create GitHub Secrets</h2><p>Now, we will create the GitHub Actions Secrets that we referred in the Dockerfile.</p><p>Log in to GitHub and go to Settings in the <code>my-flask-app</code> repository.</p><p>In the right-hand side menu, inside the Security section, click on <code>Secrets and variables</code> and click on <code>Actions</code>.</p><p><img src=/posts/how-to-automate-flask-development-workflow/screenshot-github-repo-settings.png alt="GitHub repository Settings."></p><p>In the Repository Secrets section, click on <code>New repository secret</code> button.</p><p><img src=/posts/how-to-automate-flask-development-workflow/screenshot-github-new-secret.png alt="GitHub repository Settings add new Secret."></p><p>Type in the name as <code>C8N_USERNAME</code> and secret as <code>robot_&lt;project-name>+developer</code>, which is the username of the Robot Account. Make sure to replace <code>&lt;project-name></code> with your actual project name.</p><p>Similarly, create secret <code>C8N_SECRET</code> with the Secret of the Robot Account.</p><h2 id=run-the-github-actions-workflow>Run the GitHub Actions Workflow</h2><p>To run the workflow, push an update to the <code>main</code> branch in the GitHub repo.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git add .
</span></span><span style=display:flex><span>git commit -m <span style=color:#e6db74>&#34;updated workflow&#34;</span>
</span></span><span style=display:flex><span>git push origin main
</span></span></code></pre></div><p>Go to the GitHub repo page and click on Actions. The workflow is still running - indicated by the amber color icon. It will take a few minutes to complete.</p><p><img src=/posts/how-to-automate-flask-development-workflow/screenshot-github-actions-running.png alt="GitHub repo page. The workflow is still running."></p><p>Once the workflow is completed, the icon will turn green.</p><p><img src=/posts/how-to-automate-flask-development-workflow/screenshot-github-actions-completed.png alt="GitHub repo page. The workflow is completed."></p><p>To check the workflow logs, click on the workflow. Had the workflow failed, you can identify the reason for failure by analyzing these logs.</p><p><img src=/posts/how-to-automate-flask-development-workflow/screenshot-github-actions-workflow-logs.png alt="GitHub repo page. The workflow logs."></p><p>When the workflow is successfully completed, the new version of the image will be available in the container registry.</p><p>Go to the 8gears Container Registry portal and check the repository.
Click on the repository name and confirm that the new version <code>1.0.1</code> is available in the registry.</p><p><img src=/posts/how-to-automate-flask-development-workflow/screenshot-container-registry-new-image.png alt="New image available in the registry."></p><h2 id=wrapping-up>Wrapping up</h2><p>Flask is a popular web application framework written in Python. We demonstrated
in this tutorial end-to-end how you can automate your Flask development workflows
with <a href=https://container-registry.com/>8gears Container Registry</a>
and <a href=https://docs.github.com/en/actions>GitHub Actions</a>.</p><p><br></br></p><div class="col-12 pt-5"><div class="team team-summary"><div class=team-image><img alt="Container Registry logo" class=img-fluid src=/img/logo.svg></div><div class=team-block><div class=team-meta><h3 class=team-name>Give it a try in your next project.</h3></div><div class=team-content><p>8gears Container Registry is a Harbor-based container registry as a service. You can start free and go up to any scale with our flexible plans.</p></div><a id=hero-cta-button href=/#pricing-title class="button button-secondary mt-1 btn-md text-center" style=text-decoration:none>Discover our offer</a></div></div></div></div><div class="pt-1 pb-4"><p><strong>Published</strong> â€” December 1, 2023</p><div class=post-lastupdate>Last Updated â€”
<span class=post-date-date>December 8, 2023</span></div></div><div class=post-author><div class=post-author-avatar><img src=https://container-registry.com/authors/indika-kodagoda.jpg alt></div><div class=post-author-info><a class=post-author-name href=https://container-registry.com/authors/indika-kodagoda/>Indika</a></div></div><div class="list-taxonomy post-categories"><strong>Categories:</strong>
<a href=https://container-registry.com/blog/categories/tutorial/ class="post-taxonomy post-category">Tutorial</a></div><div class="list-taxonomy post-tags"><strong>Tags:</strong>
<a href=https://container-registry.com/blog/tags/container-registry/ class="post-taxonomy post-tag">Container Registry</a>
<a href=https://container-registry.com/blog/tags/automation/ class="post-taxonomy post-tag">Automation</a></div></div></div></div></div></div></div><div class=footer><div class=container><div class=row><div class=col-12><h3 class=footer-title>Container Registry</h3></div></div></div></div><div class=footer-second><div class=container><div class=row><div class=col-12><div class=footer-second-menu><div class=row><div class="col-12 col-md-3"><h3>Site</h3><div class=menu-footer-primary><ul><li class=menu-item-home><a href=/><span>Home</span></a></li><li class=menu-item-features><a href=/#features><span>Features</span></a></li><li class=menu-item-pricing><a href=/#pricing><span>Pricing</span></a></li><li class=menu-item-contact><a href=/contact/><span>Contact</span></a></li><li class=menu-item-jobs><a href=https://8gears.notion.site/Open-Positions-c118efd6a984438b8def1bb8ae9c2419><span>Jobs</span></a></li></ul></div></div><div class="col-12 col-md-3"><h3>Services</h3><div class=menu-footer-secondary><ul><li class=menu-item-customer-portal><a href=javascript:void(0) data-cb-type=portal>Customer Portal</a></li><li class=menu-item-free-container-registry-c8n><a href=https://c8n.io><span>Free Container Registry C8N</span></a></li><li class=menu-item-container-registry-on-exoscale><a href=/exoscale/><span>Container Registry on Exoscale</span></a></li></ul></div></div><div class="col-12 col-md-3"><h3>Support</h3><div class=menu-footer-secondary><ul><li class=menu-item-knowledge-base><a href=/docs/><span>Knowledge Base</span></a></li><li class=menu-item-live-tech-support><a href=/contact/support/><span>Live Tech Support</span></a></li><li class=menu-item-privacy-policy><a href=/privacy/><span>Privacy Policy</span></a></li><li class=menu-item-service-status><a href=https://statuspage.container-registry.com><span>Service Status</span></a></li><li class=menu-item-terms-of-service><a href=/terms-of-service/><span>Terms of Service</span></a></li></ul></div></div><div class="col-12 col-md-3"><h3>Social</h3><div class=menu-footer-social><ul class=d-flex><li class="menu-item-social mr-1"><a href=https://twitter.com/ContainerRgstry target=_blank><i class="fab fa-twitter"></i></a></li><li class="menu-item-social mr-1"><a href=https://www.reddit.com/r/docker/ target=_blank><i class="fab fa-reddit-alien"></i></a></li><li class="menu-item-social mr-1"><a href=https://www.linkedin.com/showcase/container-registry target=_blank><i class="fab fa-linkedin"></i></a></li><li class="menu-item-social mr-1"><a href=/contact/ target=_blank><i class="far fa-envelope"></i></a></li></ul></div></div></div></div></div></div></div></div><div class=footer-third><div class=container><div class=row><div class=col-12><div class=text-white>Â©Copyright - Container Registry by 8gears Ltd</div></div></div></div></div><script type=text/javascript src=/js/bundle.min.abbb6bc29d048694fce685e14c036aacfdefc0cf5b41680d75e1079a109adce8.js></script><script>const queryString=window.location.search,urlParams=new URLSearchParams(queryString),custom_domain=urlParams.get("cd");for(const e of document.getElementsByName("cd_url"))e.textContent=custom_domain??"c8n.io"</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-RR0BRGBP89"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-RR0BRGBP89",{link_attribution:!0})</script><script type=text/javascript id=hs-script-loader async src=//js.hs-scripts.com/7006577.js></script></body></html>