<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>Tag Retention - Container Registry</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=https://container-registry.com/favicon.png><link rel=apple-touch-icon sizes=180x180 href=https://container-registry.com//favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://container-registry.com//favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://container-registry.com//favicon/favicon-16x16.png><link rel=manifest href=https://container-registry.com//favicon/site.webmanifest><link rel=mask-icon href=https://container-registry.com//favicon/safari-pinned-tab.svg color=#5bbad5><link rel="shortcut icon" href=https://container-registry.com//favicon/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config content="https://container-registry.com//favicon/browserconfig.xml"><meta name=theme-color content="#ffffff"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@100;500&family=Open+Sans&display=swap" rel=stylesheet><link rel=stylesheet href=/css/style.min.5bb2f1d3c72013a9130ae6c939afca2015daa440363a2897dc32570628fdb6b4.css><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-P2NXZV4');</script></head><body class="page page-docs-single"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P2NXZV4" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><div id=main-menu-mobile class=main-menu-mobile><ul><li class=menu-item-features><a href=/#features><span>Features</span></a></li><li class=menu-item-pricing><a href=/#pricing><span>Pricing</span></a></li><li class=menu-item-faq><a href=/faq/><span>FAQ</span></a></li><li class=menu-item-about><a href=/about/><span>About</span></a></li><li class=menu-item-blog><a href=/posts/><span>Blog</span></a></li><li class=menu-item-contact><a href=/contact/><span>Contact</span></a></li><li class=menu-item-jobs><a href=https://www.notion.so/8gears/Full-Stack-Software-Engineer-Python-Vue-Alpine-Container-a9a7d93f8a6b4e32b1caa11be1836810><span>Jobs</span></a></li></ul></div><div id=header class="header header-fixed"><div class=container><div class=logos><div class=logo><a href=https://container-registry.com/><img height=70px width=70px alt="Container Registry Logo" src=/img/logo.svg></a></div><div class=logo-invert><a href=https://container-registry.com/><img height=70px width=70px alt="Container Registry Logo" src=/img/logo-white.svg></a></div><div class=logo-mobile><a href=https://container-registry.com/><img height=64px width=64px alt="Container Registry Logo" src=/img/logo.svg></a></div><div class=logo-invert-mobile><a href=https://container-registry.com/><img height=64px width=64px alt="Container Registry Logo" src=/img/logo-white.svg></a></div></div><div class="docs_search search_parent"><div class=docs_search--field id=searchbox></div><div class=docs_search--result id=hits></div></div><div class=main-menu><ul><li class=menu-item-features><a href=/#features><span>Features</span></a><li class=menu-item-pricing><a href=/#pricing><span>Pricing</span></a><li class=menu-item-faq><a href=/faq/><span>FAQ</span></a><li class=menu-item-about><a href=/about/><span>About</span></a><li class=menu-item-blog><a href=/posts/><span>Blog</span></a><li class=menu-item-contact><a href=/contact/><span>Contact</span></a><li class=menu-item-jobs><a href=https://www.notion.so/8gears/Full-Stack-Software-Engineer-Python-Vue-Alpine-Container-a9a7d93f8a6b4e32b1caa11be1836810><span>Jobs</span></a></ul></div><div id=toggle-main-menu-mobile class=menu-trigger><button class=hamburger>Menu</button></div></div></div><div id=wrapper class=wrapper><div class=docs_section><div class=container><div class="row align-items-start"><div class="col-md-3 docs_sidebar"><div class=docs_sidebar-item><a class="docs_sidebar-name active" href=https://container-registry.com/docs/user-manual/>User Manual</a><ul class=docs_menu><li><a href=https://container-registry.com/docs/user-manual/why-use-container-registry/>Why Use Container Registry</a></li><li><a href=https://container-registry.com/docs/user-manual/what-is-harbor/>What Is Harbor?</a></li><li><a href=https://container-registry.com/docs/user-manual/container-registry-user-interface-a-short-overview/>Container Registry User Interface: A Short Overview</a></li><li><a href=https://container-registry.com/docs/user-manual/projects/>Working With Projects</a></li><li><a href=https://container-registry.com/docs/user-manual/images/>Working With Artifacts</a></li><ul class=docs_submenu><li><a href=https://container-registry.com/docs/user-manual/images/push-and-pull-images/>Push and Pull Images</a></li><li><a href=https://container-registry.com/docs/user-manual/images/artifact-page/>Artifact Page</a></li><li><a href=https://container-registry.com/docs/user-manual/images/working-with-tags/>Working With Tags</a></li><li><a href=https://container-registry.com/docs/user-manual/images/tags/>Tag Policies</a></li><ul class=docs_submenu><li><a href=https://container-registry.com/docs/user-manual/images/tags/tag-retention/>Tag Retention</a></li><li><a href=https://container-registry.com/docs/user-manual/images/tags/tag-immutability/>Tag Immutability</a></li></ul></ul><li><a href=https://container-registry.com/docs/user-manual/working-with-logs/>Working With Logs</a></li><li><a href=https://container-registry.com/docs/user-manual/dedicated-vs-individual-account/>Dedicated vs Individual Account</a></li><li><a href=https://container-registry.com/docs/user-manual/double-starred-patterns/>Double-Starred Patterns</a></li></ul></div><div class=docs_sidebar-item><a class=docs_sidebar-name href=https://container-registry.com/docs/getting-started-guide/>Getting Started Guide</a></div><div class=docs_sidebar-item><a class=docs_sidebar-name href=https://container-registry.com/docs/administration-manual/>Administration Manual</a></div><div class=docs_sidebar-item><a class=docs_sidebar-name href=https://container-registry.com/docs/user-guide/>User Guides</a></div></div><div class="col-md-8 offset-md-1 docs_content content"><h1 id=tag-retention>Tag Retention</h1><p>Instead of deleting tags manually, you can set when they should &ldquo;expire&rdquo; by defining the <strong>tag retention</strong>.</p><hr><p><strong>WARNING</strong></p><p>Once you set a retention rule, the artifacts that are not covered by it, will be deleted.</p><p>However, the operation is conducted at the <em>artifact level</em>. Artifacts that have more than one tag will be retained even if not all their tags are covered by the retention policy.</p><hr><h2 id=create-a-new-tag-retention-policy>Create a New Tag Retention Policy</h2><ul><li>Inside a project, go to the <strong>Policy</strong> tab (1);</li><li>Switch to <strong>TAG RETENTION</strong> (2);</li><li>Click <strong>ADD RULE</strong> (3);</li></ul><p><img src=../add_tag_rule.png alt></p><p>A dialogue window will appear:</p><p><img src=../retention_policy.png alt></p><h3 id=select-repos>Select Repos</h3><p>To specify repositories where the policy should look for the tags to be retained:</p><ul><li>type certain repositories in separating them by commans <em>or</em></li><li>use a <a href=https://preview.container-registry.com/docs/user-manual/double-starred-patterns/>double- or single-starred pattern</a>;</li><li>select between <strong>matching</strong> and <strong>excluding</strong> from the dropdown to include or exclude specified repositories;</li></ul><h3 id=select-tag-age-or-number>Select Tag Age or Number</h3><p>To specify how artifacts should be selected for retention, use one of the following options from the second dropdown:</p><ul><li>to refer to the number of artifacts stored in a repo:<ul><li>select <strong>retain the most recently pushed # artifacts</strong> and type in the number of artifacts to be retained in the <em>COUNT</em> field;</li><li>select <strong>retain the most recently pulled # artifacts</strong> and type in the number of artifacts to be retained in the <em>COUNT</em> field;</li></ul></li><li>to refer to the artifacts &ldquo;age&rdquo;:<ul><li>select <strong>retain the artifacts pushed within the last # days</strong> and fill in the <em>DAYS</em> field;</li><li>select <strong>retain the artifacts pulled within the last # days</strong> and fill in the <em>DAYS</em> field;</li></ul></li><li>select <strong>retain always</strong> will keep the artifacts and tags forever.</li></ul><h3 id=select-tags-by-name>Select Tags by Name</h3><p>To specify the tags to be retained:</p><ul><li>type in certain tags separated by commas <em>or</em></li><li>use a <a href=https://preview.container-registry.com/docs/user-manual/double-starred-patterns/>double- or single-starred pattern</a>;</li><li>select between <strong>matching</strong> and <strong>excluding</strong> to include or exclude selected tags;</li><li>check <em>untagged artifacts</em> if you want to include artifacts that have no tag.</li></ul><h2 id=manage-tag-retention-rules>Manage Tag Retention Rules</h2><p>You can edit, disable/enable, and delete a tag retention rule using the <strong>Action</strong> button next to each rule.
<img src=../manage_retention.png alt>
Disabled rules will be marked with a red exclamation mark.
<img src=../disabled_retention.png alt></p><h2 id=run-retention-rules>Run Retention Rules</h2><p>Retention rules do nothing until they are run proactively. Indeed, it means that no tags or artifacts are deleted before you run a retention rule. You can do it either manually or create a schedule for it.</p><h3 id=run-the-retention-manually>Run the Retention Manually</h3><p>If you want the retention to take an effect immediately, you can use the <strong>RUN NOW (1)</strong> button. But, before doing this, we highly recommend using <strong>DRY RUN (2)</strong> which only simulates the retention policy execution and provides a log <strong>(4)</strong> describing once again which artifacts and tags are to be deleted or retained. Use <strong>ABORT (3)</strong> to stop an execution.
<img src=../run_retention.png alt>
Example of the log data:</p><pre><code>2021-08-12T14:27:34Z [INFO] [/pkg/retention/job.go:83]: Run retention process.
 Repository: library/test 
 Rule Algorithm: or 
 Dry Run: true
2021-08-12T14:27:34Z [INFO] [/pkg/retention/job.go:98]: Load 2 candidates from repository library/test
2021-08-12T14:27:34Z [INFO] [/pkg/retention/job.go:201]: 
|                                 Digest                                  |   Tag    | Kind  | Labels |     PushedTime      |     PulledTime      |     CreatedTime     | Retention |
|-------------------------------------------------------------------------|----------|-------|--------|---------------------|---------------------|---------------------|-----------|
| sha256:1b26826f602946860c279fce658f31050cff2c596583af237d971f4629b57792 | 4.0,test | image |        | 2021/08/12 14:26:29 | 2021/08/11 14:32:52 | 2021/08/11 08:30:49 | RETAIN    |
| sha256:1649f969e17dff21275d1e227581fd492c77c9d856f989c2a1188a5798f6dfd2 | 2.0,1.0  | image |        | 2021/08/04 12:47:31 | 2021/08/11 14:32:53 | 2021/07/29 12:02:18 | DEL       |
</code></pre><h3 id=schedule-the-execution-of-the-retention-rule>Schedule the Execution of the Retention Rule</h3><p>To make the retention execution happen automatically and on a regular basis, you can create a schedule for the policy to run.</p><ul><li>Go to the <strong>Schedule</strong>;</li><li>Click <strong>EDIT</strong>;</li><li>Select a schedule from the dropdown;</li></ul><p><img src=../retention_schedule.png alt></p><ul><li>If you select CRON, you need to create specify the frequency using the <a href=https://crontab.guru>online CRON formatter</a> (copy and paste the value from it);<ul><li>Alternatively, consult our short knowledge article by clicking on the <em>i</em> icon and create the schedule by yourself.</li></ul></li></ul><p><img src=../cron_retention_schedule.png alt></p></div></div></div></div></div><div class=footer><div class=container><div class=row><div class=col-12><h3 class=footer-title>Container Registry</h3></div></div></div></div><div class=footer-second><div class=container><div class=row><div class=col-12><div class=footer-second-menu><div class=row><div class="col-12 col-md-3"><h3>Site</h3><div class=menu-footer-primary><ul><li class=menu-item-home><a href=/><span>Home</span></a></li><li class=menu-item-features><a href=/#features><span>Features</span></a></li><li class=menu-item-pricing><a href=/#pricing><span>Pricing</span></a></li><li class=menu-item-contact><a href=/contact/><span>Contact</span></a></li><li class=menu-item-jobs><a href=https://www.notion.so/8gears/Full-Stack-Software-Engineer-Python-Vue-Alpine-Container-a9a7d93f8a6b4e32b1caa11be1836810><span>Jobs</span></a></li></ul></div></div><div class="col-12 col-md-3"><h3>Services</h3><div class=menu-footer-secondary><ul><li class="menu-item-customer portal"><a id=customer-portal href=javascript:void(0) data-billsby-type=account>Customer Portal</a></li><li class="menu-item-c8n free regsitry"><a href=https://c8n.io><span>C8N Free Regsitry</span></a></li></ul></div></div><div class="col-12 col-md-3"><h3>Support</h3><div class=menu-footer-secondary><ul><li class="menu-item-privacy policy"><a href=/privacy/><span>Privacy Policy</span></a></li><li class="menu-item-terms of service"><a href=/terms-of-service/><span>Terms of Service</span></a></li></ul></div></div><div class="col-12 col-md-3"><h3>Social</h3><div class=menu-footer-social><ul class=d-flex><li class="menu-item-social mr-1"><a href=https://twitter.com/ContainerRgstry target=_blank><i class="fab fa-twitter"></i></a></li><li class="menu-item-social mr-1"><a href=https://www.reddit.com/r/docker/ target=_blank><i class="fab fa-reddit-alien"></i></a></li><li class="menu-item-social mr-1"><a href=https://www.linkedin.com/showcase/container-registry target=_blank><i class="fab fa-linkedin"></i></a></li><li class="menu-item-social mr-1"><a href=/contact/ target=_blank><i class="far fa-envelope"></i></a></li></ul></div></div></div></div></div></div></div></div><div class=footer-third><div class=container><div class=row><div class=col-12><div class=text-white>©Copyright - Container Registry by 8gears Ltd</div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/algoliasearch@4.5.1/dist/algoliasearch-lite.umd.js></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4.8.3/dist/instantsearch.production.min.js></script><script type=text/javascript src=/js/bundle.min.0badd4c1778bb1d3e6632a64cb596ad2129bf65564e35bf4cdd2e2f3215b8d81.js></script><script>const queryString=window.location.search;const urlParams=new URLSearchParams(queryString);const custom_domain=urlParams.get('cd');for(const elem of document.getElementsByName("cd_url")){elem.textContent=custom_domain!=undefined?custom_domain:"c8n.io";};</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-179953813-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-179953813-1',{'link_attribution':true});</script><script type=text/javascript id=hs-script-loader async src=//js.hs-scripts.com/7006577.js></script></body></html>